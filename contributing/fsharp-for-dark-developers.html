<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-contributing/fsharp-for-dark-developers">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">F# for Darklang developers | Dark Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.darklang.com/img/favicon.ico"><meta data-rh="true" name="twitter:image" content="https://docs.darklang.com/img/favicon.ico"><meta data-rh="true" property="og:url" content="https://docs.darklang.com/contributing/fsharp-for-dark-developers"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="F# for Darklang developers | Dark Documentation"><meta data-rh="true" name="description" content="This guide aims to introduce you to enough F# contribute to Darklang, assuming"><meta data-rh="true" property="og:description" content="This guide aims to introduce you to enough F# contribute to Darklang, assuming"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.darklang.com/contributing/fsharp-for-dark-developers"><link data-rh="true" rel="alternate" href="https://docs.darklang.com/contributing/fsharp-for-dark-developers" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.darklang.com/contributing/fsharp-for-dark-developers" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QFOZBC0VVL-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-159199190-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Dark Documentation" href="/opensearch.xml">
<link rel="preconnect" href="https://cdn.heapanalytics.com">
<link rel="dns-prefetch" href="https://cdn.heapanalytics.com">
<script>window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://cdn.heapanalytics.com/js/heap-"+e+".js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a);for(var n=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],o=0;o<p.length;o++)heap[p[o]]=n(p[o])},heap.load(477722926)</script>
<link rel="preconnect" href="https://cdn.heysavvy.com">
<link rel="dns-prefetch" href="https://cdn.heysavvy.com"><link rel="stylesheet" href="/assets/css/styles.5ca4c912.css">
<link rel="preload" href="/assets/js/runtime~main.cb5a5ae5.js" as="script">
<link rel="preload" href="/assets/js/main.85c79e4d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://darklang.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/favicon.ico" alt="Darklang logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/favicon.ico" alt="Darklang logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Darklang</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction">Documentation</a><a class="navbar__item navbar__link" href="/tutorials/first-dark-application">Tutorial</a><a class="navbar__item navbar__link" href="/contributing/getting-started">Contributing</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/contributing/getting-started">Your First Contribution</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/contributing/next-contribution">Your Next Contributions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/contributing/fsharp-for-dark-developers">Working in the Dark repo</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/contributing/fsharp-for-dark-developers">F# for Darklang developers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/general-concepts">General concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/tour-of-backend">A tour of the Backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/repo-layout">Repository directory structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/making-a-pull-request">Making a Pull Request</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/new-release-checklist">New-Release Checklist</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Working in the Dark repo</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">F# for Darklang developers</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>F# for Darklang developers</h1></header><p>This guide aims to introduce you to enough F# contribute to Darklang, assuming
you already know Darklang.</p><h2 id="some-simple-f-code">Some simple F<!-- -->#<!-- --> code</h2><p>Darklang and F# are very similar. Here&#x27;s an example function in F#:</p><pre><code class="language-fsharp">let someFunction (intArgument : int) : string =
  let aString = &quot;myString&quot;
  let anInt = 65 + intArgument
  let aFloat = 6.72
  anotherFunction aString anInt aFloat
</code></pre><p>This is a function called <code>someFunction</code>, which takes one argument, an <code>int</code>
called <code>intArgument</code>, and returns a <code>string</code>. Three variables are defined in the
body, first a string, then an int, then a float, and finally we call the
<code>anotherFunction</code> function with all three parameters as arguments.</p><p>In Darklang this would be written:</p><pre><code class="language-fsharp">someFunction
  intArgument : Int
  ↪ String

let aString = &quot;myString&quot;
let anInt = 65 + intArgument
let aFloat = 6.72
anotherFunction aString anInt aFloat
</code></pre><h2 id="darklang-vs-f">Darklang vs F<!-- -->#</h2><p>Darklang and F# are all influenced by OCaml. Though Darklang is currently a
subset of these languages, Darklang will continue to grow some more of their
features. We&#x27;ll discuss the similarities and differences as we go through
language features.</p><h3 id="types">Types</h3><p>F# is a strongly typed-languages. Darklang aspires to be, but it doesn&#x27;t have a
type-checker yet. This shows the biggest difference in between working in these
languages, that the compiler will refuse to compile if the types are wrong.</p><p>F# has type-inference, which means that the compiler will try and figure out
what the types are. Usually type errors actually contain useful information, but
they need to be read very carefully to find it.</p><p>We&#x27;ve found the best way to debug incorrect types is to add type annotations to
everything. We add them to all functions (we didn&#x27;t always do this, but we do
now, but we are now), including all parameters and return types (see
<a href="#functions">example</a> below).</p><p>In F#, you can actually add types in many places where they aren&#x27;t required,
such as variable definitions:</p><pre><code class="language-fsharp">let y = 6.7
let (x : int) = 6
x + 5
</code></pre><p><code>x</code> here, despite being a normal variable definition, has a type signature. F#
allows this in many places, and it&#x27;s useful for tracking down these errors.</p><p>We&#x27;ll discuss declaring types below.</p><h3 id="functions">Functions</h3><p>Functions in F# are defined in the outer scope. Type signatures are optional but
we always use them:</p><pre><code class="language-fsharp">let myFunction (arg1 : int) (arg2 : string) : string =
  if arg1 &lt; (String.toInt arg2)
  then &quot;just return a string&quot;
  else arg2
</code></pre><p>Here, <code>myFunction</code> has two arguments, <code>arg1</code> and <code>arg2</code>, which are an <code>int</code> and
<code>string</code> respectively. It returns a <code>string</code>.</p><p>Like in Darklang, the body of a function is just an expression, and it
automatically returns the result of that expression.</p><p>(see <a href="#advanced-functions">below</a> for more details on functions in F#)</p><h3 id="standard-library">Standard library</h3><p>Most of the code in Darklang uses
<a href="https://github.com/darklang/tablecloth">Tablecloth</a>.</p><p>Note: for implementing the standard libraries, we do not use Tablecloth as it is
still pretty new and may be in flux. Instead, we try to make sure that we use
libraries from <code>.NET</code>, FSharp.Core, or if necessary, the FSharpPlus library.</p><h3 id="int">Int</h3><p>An <code>int</code> is the same in Darklang and F#, same syntax, same meaning. Note that
ints are 32-bit in F#, and 64-bit in Darklang.</p><pre><code class="language-fsharp">let x = 5
x + 6
</code></pre><h3 id="float">Float</h3><p>A <code>float</code> is the same in Darklang and F#, both of them are 64-bit floating point
numbers.</p><p>To convert from floats to ints use <code>Float.toInt</code>, or <code>Float.round</code>.</p><h3 id="bool">Bool</h3><p>Like in Darklang, <code>bool</code>s in F# are either <code>true</code> or <code>false</code>.</p><h3 id="string">String</h3><p>Strings are Unicode in Darklang and F#. While you&#x27;re unlikely to hit differences
in practice, they do actually use a different in-memory representation, with
Darklang using UTF-8, and F# using .NET&#x27;s UTF-16.</p><pre><code class="language-fsharp">let myString = &quot;some string, escaping is allowed\nwhich dark doesn&#x27;t support yet&quot; in
myString
</code></pre><h3 id="string-interpolation">String Interpolation</h3><p>Darklang and F# support string interpolation. In F#:</p><pre><code class="language-fsharp">let x = 6
let y = 7.8
let myString = $&quot;some string with x: {x} and also {y}&quot;
</code></pre><h3 id="list">List</h3><p>Lists in Darklang and F# are almost the same. In F#, lists use <code>;</code> as
separators, like so:</p><pre><code class="language-fsharp">[1; 2; 3; 4]
</code></pre><p>(However, F# allows separators to be omitted which the list elements are lined
up vertically, as it uses indentation as the separator).</p><p>While Darklang technically allows you to create lists that have different types
in them (which you should not do), F# emphatically does not.</p><p>To type check a list in F#, you use <code>List&lt;int&gt;</code>.</p><h3 id="records">Records</h3><p>Records are mostly used as objects are in most languages. Like Darklang, they
only have fields, not methods, and you use functions to manipulate them.</p><p>F# uses a familiar syntax, but with <code>=</code> instead of <code>:</code>. It also allows you tes
use indentation instead of separators:</p><pre><code class="language-fsharp">{
  field1 = 56
  field2 = true
  field3 = &quot;asd&quot;
}
</code></pre><p>Note that F# uses <code>=</code> to connect a field and a value, and <code>;</code> as row separator.
The types of the fields do not have to be declared.</p><p>Records are immutable, like almost everything in F#, and are updated using an
unusual syntax:</p><pre><code class="language-fsharp">let x = { field1 = 56; field2 = true }
let updatedX = { x with field1 = 57 }
doSomethingWith updatedX
</code></pre><p>Note that records in Darklang are really dictionaries, which is why you update
them with <code>Dict::set</code>. We&#x27;re trying to figure out how to split records and
dictionaries apart better in Darklang, after which they will be more like F#.</p><p>Type definitions for records look like this in F#:</p><pre><code class="language-fsharp">type Person =
  {
    name : string
  ; age : int
  }
</code></pre><h3 id="let">Let</h3><p><code>let</code>s in F# are the same as in Darklang:</p><pre><code class="language-fsharp">let x = 45
x + 23
</code></pre><p><code>let</code> also allow destructing in F#, although we don&#x27;t currently use that very
often.</p><h3 id="if">If</h3><p><code>if</code> statements in F# are extremely similar to Darklang, including that they
only allow <code>bool</code>s as the condition, and in their syntax.</p><p>In F#:</p><pre><code class="language-fsharp">if hasAccess user
then &quot;Welcome!&quot;
else &quot;Access denied&quot;
</code></pre><h3 id="operators">Operators</h3><p>F# has some unusual operators. Most importantly, the equality operator is <code>=</code>
(that&#x27;s just one equals sign), whereas in most languages it&#x27;s <code>==</code> (including
Darklang). <code>=</code> is very strict equality, equivalent to <code>===</code> in languages that
have that, such as JS.</p><p>F# also has a <code>==</code> operator, but you should never use it.</p><p>F# use <code>&lt;&gt;</code> for inequality (<code>!=</code> in Darklang).</p><h3 id="match">Match</h3><p>Darklang has a <code>match</code> statement that is very similar to F#, with slightly
different syntax. In Darklang you write:</p><pre><code class="language-fsharp">match myValue
  Some x -&gt; 5
  _ -&gt; 6
</code></pre><p>while in F# you write</p><pre><code class="language-fsharp">match myValue with
| Some x -&gt; 5
| _ -&gt; 6
</code></pre><p>Notice the <code>with</code> keyword, and starting the patterns with <code>|</code>.</p><p>F# also support more powerful <code>match</code>es, for example multiple patterns can match
a single branch:</p><pre><code class="language-fsharp">match myValue with
| 4 | 5 | 6 -&gt; &quot;between 4 and 6&quot;
| _ -&gt; &quot;not between 4 and 6&quot;
</code></pre><p>F# also supports the <code>when</code> clause:</p><pre><code class="language-fsharp">match myValue with
| Some myInt when myInt &gt;= 4 &amp;&amp; myInt &lt;= 6 -&gt; &quot;between 4 and 6&quot;
| _ -&gt; &quot;not between 4 and 6&quot;
</code></pre><h3 id="variants">Variants</h3><p>Darklang has a handful of enums for <code>Option</code> and <code>Result</code> types: <code>Just</code>,
<code>Nothing</code>, <code>Ok</code> and <code>Error</code>. In the future we will expand this to allow
user-defined types as well.</p><p>F# supports the <code>Option</code> and <code>Result</code> types and we use them a lot. However, the
constructors for Option are named differently; both languages use: <code>Some</code> and
<code>None</code> instead of <code>Just</code> and <code>Nothing</code>.</p><p>These enums are typically called &quot;variants&quot;. We use them frequently, especially
to represent expressions. For example in <code>FluidExpression.fs</code>:</p><pre><code class="language-fsharp">type Expr =
  | EInteger of id * int64
  | EBool of id * bool
  | EString of id * string
  | EFloat of id * string * string
  | ENull of id
  | EBlank of id
  | ELet of id * string * Expr * Expr
  | EIf of id * Expr * Expr * Expr
  | EBinOp of id * string * Expr * Expr * sendToRail
  | ELambda of id * List&lt;(analysisID * string)&gt; * Expr
  | EFieldAccess of id * Expr * string
  | EVariable of id * string
  | EFnCall of id * string * List&lt;Expr&gt; * sendToRail
  | EList of id * List&lt;Expr&gt;
  | ERecord of id * (string * Expr) list
  | EPipe of id * List&lt;Expr&gt;
  | EConstructor of id * string * List&lt;Expr&gt;
  | EMatch of id * Expr * List&lt;(MatchPattern * Expr)&gt;
  | EPipeTarget of id
</code></pre><pre><code class="language-fsharp">let expr = EInteger (id, &quot;test&quot;)
</code></pre><p>To get values from them, you pattern match:</p><pre><code class="language-fsharp">match expr with
| EInteger (_, str) -&gt; str
| _ -&gt; &quot;not an int&quot;
</code></pre><h3 id="lambdas">Lambdas</h3><p>F# supports lambdas and we use them frequently. They have a different syntax to
Darklang, F# uses:</p><pre><code class="language-fsharp">list
|&gt; List.map (fun elem -&gt; elem + 2)
</code></pre><h3 id="pipes">Pipes</h3><p>Both languages have pipes which are the same as in Darklang. In Darklang, the
passed argument goes into the first position. That is not true F#, where it goes
into the last position. As a result, we tend to put the &quot;subject&quot; of the
function in the pipeable position (first in Darklang, last in F#).</p><h3 id="dictionaries">Dictionaries</h3><p>Dictionaries (hash-maps, etc) are called <code>Map</code> in F#.</p><h3 id="unit">Unit</h3><p>F# and Darklang have a <code>unit</code> type, whose only member is <code>()</code>. That&#x27;s an actual
value, for example, all this is valid code:</p><pre><code class="language-fsharp">let falseVar = () != () in
</code></pre><p>It&#x27;s typically used to pass to a function which is impure but doesn&#x27;t have any
meaningful arguments, such as <code>gid ()</code> (which generates IDs).</p><h3 id="error-handling">Error handling</h3><p>Typically we use <code>Result</code> or <code>Option</code>s for error handling. You&#x27;ll very commonly
see something like</p><pre><code class="language-fsharp">let isRailable (m : model) (name : string) =
  m.functions
  |&gt; Functions.find name
  |&gt; Option.map (fun fn -&gt;
         fn.fnReturnTipe = TOption || fn.fnReturnTipe = TResult)
  |&gt; Option.withDefault false
</code></pre><p>To find out if a function goes on the error rail, we search for a function,
which returns an Option. We then use a <code>map</code> to operate on the option, and
finally choose a default in case the Option returned <code>None</code>.</p><h4 id="exceptions">Exceptions</h4><p>F# has exceptions - thought we&#x27;d like to use them less.</p><p>Unfortunately, it&#x27;s hard to tell when an exception could be thrown.</p><h3 id="imperative-programming">Imperative programming</h3><p>F# supports imperative programming which Darklang does not support yet.</p><p>F# has mutable values that it prefers to refs (it has refs, but they&#x27;re
deprecated). Mutable values are used like so:</p><pre><code class="language-fsharp">let mutable myString = &quot;old value&quot;
myString &lt;- &quot;new value&quot;
print(myString)
</code></pre><h3 id="asynctasks">Async/Tasks</h3><p>For functions that perform IO, you&#x27;ll need to use the <code>uply</code> or <code>task</code>
&quot;computation expression&quot;. A &quot;computation expression&quot; is a special F# language
feature for writing abstractions with a nice syntax. The <code>uply</code> CE allows using
a specialized asynchronous structure called Ply (which is extremely similar to a
.Net Task) easily, and can best be illustrated with an example:</p><pre><code class="language-fsharp">  (function
  | state, [ DObj value; DStr key; DDB dbname ] -&gt;
      uply {
        let db = state.dbs.[dbname]
        let! _id = UserDB.set state true db key value
        return DObj value
      }
  | _ -&gt; incorrectArgs ())
</code></pre><p>Let&#x27;s break this down line by line:</p><ul><li><code>uply {</code>: this creates the CE, whose return value will be a <code>Ply&lt;&#x27;any&gt;</code>.</li><li><code>let db = state.dbs.[dbname]</code> - this is just regular F# code</li><li><code>let! _id = UserDB.set state true db key value</code> - the special thing here is
the <code>let!</code> - this line calls <code>UserDB.set</code>, a function which returns a <code>Ply</code>,
and unwraps the <code>Ply</code>. This means that <code>_id</code> can be treated as a normal value
for the rest of this <code>taskv</code>.</li><li><code>return DObj value</code> - return takes an ordinary value and turns it into a
<code>Ply</code>, in this case a <code>Ply&lt;Dval&gt;</code>.</li></ul><p>Why do we go through all this trouble? Because this is an async runtime, and
<code>let!</code> and <code>return</code> are the enablers of the asynchronicity. A <code>Ply</code> is a
promise, and <code>let!</code> waits for the promise and then continues (running other code
while the IO is still pending). This is the exact same as the <code>async</code> keyword in
JS, Rust, C# or Python.</p><p>Note that while we primarily use <code>Ply</code> and <code>uply</code> inside the Interpreter, most
of our other async code use <code>Task</code> and <code>task</code>. These are interchangeable except
that Tasks are a little slower.</p><h3 id="advanced-functions">Advanced functions</h3><h4 id="partial-application--currying">Partial application / currying</h4><p>Occasionally you&#x27;ll see a function called with fewer arguments than it has
parameters:</p><pre><code class="language-fsharp">let myFunction (param1: int) (param2 : string) =
  ...body...

let myOtherFunction = myFunction 6
</code></pre><p>This is called &quot;partial application&quot;, in that the function is only partially
called (this is often called <em>Currying</em> in the functional language community).
This just means that some parameters are filled in, and you now have a function
which can be called with the remaining parameters:</p><pre><code class="language-fsharp">let () =
  myOtherfunction &quot;final argument&quot;
</code></pre><p>This is the same as if it were defined as:</p><pre><code class="language-fsharp">let myOtherFunction (param : string) =
  myFunction 6 param
</code></pre><h2 id="darklangs-codebase-history">Darklang&#x27;s codebase history</h2><p>Darklang&#x27;s backend was originally written in OCaml, and then ported to F# in
2021/2022. A lot of code is written the way it is because that made sense in
OCaml, especially code with the comment <code>// CLEANUP</code> in it.</p><p>Darklang&#x27;s frontend was originally written in Elm, before being ported to
ReScript. It was removed in 2023.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/darklang/docs/edit/main/docs/contributing/fsharp-for-dark-developers.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/contributing/adding-a-refactoring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Adding a refactoring</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/contributing/general-concepts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">General concepts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#some-simple-f-code" class="table-of-contents__link toc-highlight">Some simple F# code</a></li><li><a href="#darklang-vs-f" class="table-of-contents__link toc-highlight">Darklang vs F#</a><ul><li><a href="#types" class="table-of-contents__link toc-highlight">Types</a></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a></li><li><a href="#standard-library" class="table-of-contents__link toc-highlight">Standard library</a></li><li><a href="#int" class="table-of-contents__link toc-highlight">Int</a></li><li><a href="#float" class="table-of-contents__link toc-highlight">Float</a></li><li><a href="#bool" class="table-of-contents__link toc-highlight">Bool</a></li><li><a href="#string" class="table-of-contents__link toc-highlight">String</a></li><li><a href="#string-interpolation" class="table-of-contents__link toc-highlight">String Interpolation</a></li><li><a href="#list" class="table-of-contents__link toc-highlight">List</a></li><li><a href="#records" class="table-of-contents__link toc-highlight">Records</a></li><li><a href="#let" class="table-of-contents__link toc-highlight">Let</a></li><li><a href="#if" class="table-of-contents__link toc-highlight">If</a></li><li><a href="#operators" class="table-of-contents__link toc-highlight">Operators</a></li><li><a href="#match" class="table-of-contents__link toc-highlight">Match</a></li><li><a href="#variants" class="table-of-contents__link toc-highlight">Variants</a></li><li><a href="#lambdas" class="table-of-contents__link toc-highlight">Lambdas</a></li><li><a href="#pipes" class="table-of-contents__link toc-highlight">Pipes</a></li><li><a href="#dictionaries" class="table-of-contents__link toc-highlight">Dictionaries</a></li><li><a href="#unit" class="table-of-contents__link toc-highlight">Unit</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error handling</a></li><li><a href="#imperative-programming" class="table-of-contents__link toc-highlight">Imperative programming</a></li><li><a href="#asynctasks" class="table-of-contents__link toc-highlight">Async/Tasks</a></li><li><a href="#advanced-functions" class="table-of-contents__link toc-highlight">Advanced functions</a></li></ul></li><li><a href="#darklangs-codebase-history" class="table-of-contents__link toc-highlight">Darklang&#39;s codebase history</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learning</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://darklang.com/launch/demo-video" target="_blank" rel="noopener noreferrer" class="footer__link-item">Demo Video</a></li><li class="footer__item"><a href="https://youtube.com/c/Darklang/videos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorial Videos</a></li><li class="footer__item"><a href="https://darklang.com/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/first-dark-application">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/category/walk-throughs">Walk-throughs</a></li></ul></div><div class="col footer__col"><div class="footer__title">About</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://darklang.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Company</a></li><li class="footer__item"><a href="https://blog.darklang.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://darklang.com/discord-invite" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Discord</a></li><li class="footer__item"><a href="https://github.com/darklang/dark" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dark Repo</a></li><li class="footer__item"><a href="https://github.com/darklang/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docs Repo</a></li><li class="footer__item"><a class="footer__link-item" href="/contributing/getting-started">Contributor Docs</a></li><li class="footer__item"><a href="https://darklang.com/code-of-conduct" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code of Conduct</a></li></ul></div><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://darklang.com/login" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sign in</a></li><li class="footer__item"><a href="https://darklang.com/signup" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sign up</a></li><li class="footer__item"><a href="https://darklang.com/desktop-client" target="_blank" rel="noopener noreferrer" class="footer__link-item">Desktop Client</a></li><li class="footer__item"><a href="https://darklang.com/mailing-list" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li><li class="footer__item"><a class="footer__link-item" href="/reference/changelog">Changelog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Dark Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cb5a5ae5.js"></script>
<script src="/assets/js/main.85c79e4d.js"></script>
<script async="true" defer="true" src="https://cdn.heysavvy.com/wc/savvy.min.js"></script>
        <savvy-smart-form id="6HBmUjmI12nCuopyvB0B"></savvy-smart-form></body>
</html>