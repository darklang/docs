"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6193],{3905:(t,e,n)=>{n.d(e,{Zo:()=>d,kt:()=>h});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},i=Object.keys(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var c=a.createContext({}),s=function(t){var e=a.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},d=function(t){var e=s(t.components);return a.createElement(c.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,i=t.originalType,c=t.parentName,d=l(t,["components","mdxType","originalType","parentName"]),u=s(n),h=r,m=u["".concat(c,".").concat(h)]||u[h]||p[h]||i;return n?a.createElement(m,o(o({ref:e},d),{},{components:n})):a.createElement(m,o({ref:e},d))}));function h(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var c in e)hasOwnProperty.call(e,c)&&(l[c]=e[c]);l.originalType=t,l.mdxType="string"==typeof t?t:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6724:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>p});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],l={title:"Tutorial: Extract code into a function",sidebar_label:"Extract code into a Function",id:"extract-function"},c=void 0,s={unversionedId:"tutorials/extract-function",id:"tutorials/extract-function",title:"Tutorial: Extract code into a function",description:"Next, we'll create the human readable summary of the daily reports. To ensure",source:"@site/docs-classic/tutorials/07-extract-function.md",sourceDirName:"tutorials",slug:"/tutorials/extract-function",permalink:"/tutorials/extract-function",draft:!1,editUrl:"https://github.com/darklang/docs/edit/main/docs-classic/tutorials/07-extract-function.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Tutorial: Extract code into a function",sidebar_label:"Extract code into a Function",id:"extract-function"},sidebar:"docs",previous:{title:"Process background jobs in a Worker",permalink:"/tutorials/process-background-jobs-worker"},next:{title:"Call an external API",permalink:"/tutorials/call-external-api"}},d={},p=[],u={toc:p};function h(t){var e=t.components,l=(0,r.Z)(t,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,l,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Next, we'll create the human readable summary of the daily reports. To ensure\nthat our code is well architected, we'll put this code in a function."),(0,i.kt)("p",null,"The best way to create a function is by writing the code you want as part of\nyour handler, and then extracting the working code to a function. This ensures\nthat whatever code you write has traces and live data."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Start by creating a new REPL.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the REPL, call ",(0,i.kt)("inlineCode",{parentName:"p"},"DB::getAll")," to get the reports from the datastore. Run the\nfunction using the play button (\u25b6\ufe0f)."))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(52380).Z,width:"832",height:"210"})),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"Open a pipeline by typing ",(0,i.kt)("inlineCode",{parentName:"li"},"|>"),", and pipe into a ",(0,i.kt)("inlineCode",{parentName:"li"},"List::map"),", and create\nvariables ",(0,i.kt)("inlineCode",{parentName:"li"},"date")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"count"),".")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(67437).Z,width:"876",height:"280"})),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"Pipe ",(0,i.kt)("inlineCode",{parentName:"li"},"val.count")," into ",(0,i.kt)("inlineCode",{parentName:"li"},"toString")," (shift-enter on a selected area also pipes\nthat expression).")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(26765).Z,width:"864",height:"320"})),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Return ",(0,i.kt)("inlineCode",{parentName:"li"},'date ++ ": " ++ count')," in the last line of the block.")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(7692).Z,width:"830",height:"346"})),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"We now have the code to generate our formatted report."),(0,i.kt)("p",{parentName:"li"},"Let's extract that code into a function. Select all the code within the REPL."))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(21381).Z,width:"1204",height:"648"})),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"Type ",(0,i.kt)("inlineCode",{parentName:"li"},"Ctrl-\\")," to open the command palette, then select ",(0,i.kt)("inlineCode",{parentName:"li"},"extract-function"),".\n(On some keyboards, you might instead need to press ",(0,i.kt)("inlineCode",{parentName:"li"},"Alt-x")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"Ctrl-s"),").")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(62411).Z,width:"1154",height:"666"})),(0,i.kt)("ol",{start:8},(0,i.kt)("li",{parentName:"ol"},"This creates the function, and replaces the existing code with a call to the\nnew function.")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(78158).Z,width:"852",height:"220"})),(0,i.kt)("ol",{start:9},(0,i.kt)("li",{parentName:"ol"},"Click on the function reference on the right hand side of the handler to go\nto the function and rename it.")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(69463).Z,width:"1352",height:"608"})),(0,i.kt)("p",null,"Functions do not live on the main canvas. They are reusable and can be called\nfrom any handler."),(0,i.kt)("p",null,"This function does not have any parameters. When you add parameters, the editor\nwill automatically create blanks for the arguments everywhere the function is\ncalled."),(0,i.kt)("ol",{start:10},(0,i.kt)("li",{parentName:"ol"},"Go back to the primary canvas via the sidebar, the mini-map, or a reference\non the right-hand-side of the function. Once back, create a new HTTP GET\nhandler and call the function. This creates an API endpoint which returns\nthe daily reports.")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"gettingstarted/newworker.png",src:n(24029).Z,width:"848",height:"168"})))}h.isMDXComponent=!0},7692:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/blockend-d094c72b13df470fb6a58bc9cdc7ac21.png"},52380:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/dbgetalldaily-0235edadce463fc4a6460bef43beb492.png"},78158:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/extractedfunction-fed2381a77887ecfa7cc1ecc0d28d6d9.png"},62411:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/extractfunction-180da21eda6eedac4909710b54f9d018.png"},24029:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/functioncall-6e7facf6dbfa762b5c0d04cf5e2c6039.png"},67437:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/functionmapvariable-dab7ae5bd3a2b471e551c4a3c965db00.png"},69463:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/functionspace-ff35a482e6bbc917dc2207e1abad6b0f.png"},21381:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/selectall-84b442d6952553ab5aa26346308c7dc3.png"},26765:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/valcounttostring-fdc1a8039875e32a597b3e971475504c.png"}}]);