"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3702],{71135:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"tutorials/extract-function","title":"Tutorial: Extract code into a function","description":"Next, we\'ll create the human readable summary of the daily reports. To ensure","source":"@site/docs-classic/tutorials/07-extract-function.md","sourceDirName":"tutorials","slug":"/tutorials/extract-function","permalink":"/tutorials/extract-function","draft":false,"unlisted":false,"editUrl":"https://github.com/darklang/docs/edit/main/docs-classic/tutorials/07-extract-function.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Tutorial: Extract code into a function","sidebar_label":"Extract code into a Function","id":"extract-function"},"sidebar":"docs","previous":{"title":"Process background jobs in a Worker","permalink":"/tutorials/process-background-jobs-worker"},"next":{"title":"Call an external API","permalink":"/tutorials/call-external-api"}}');var a=n(74848),i=n(28453);const r={title:"Tutorial: Extract code into a function",sidebar_label:"Extract code into a Function",id:"extract-function"},c=void 0,o={},d=[];function l(e){const t={code:"code",img:"img",li:"li",ol:"ol",p:"p",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"Next, we'll create the human readable summary of the daily reports. To ensure\nthat our code is well architected, we'll put this code in a function."}),"\n",(0,a.jsx)(t.p,{children:"The best way to create a function is by writing the code you want as part of\nyour handler, and then extracting the working code to a function. This ensures\nthat whatever code you write has traces and live data."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Start by creating a new REPL."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["In the REPL, call ",(0,a.jsx)(t.code,{children:"DB::getAll"})," to get the reports from the datastore. Run the\nfunction using the play button (\u25b6\ufe0f)."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(52805).A+"",width:"832",height:"210"})}),"\n",(0,a.jsxs)(t.ol,{start:"3",children:["\n",(0,a.jsxs)(t.li,{children:["Open a pipeline by typing ",(0,a.jsx)(t.code,{children:"|>"}),", and pipe into a ",(0,a.jsx)(t.code,{children:"List::map"}),", and create\nvariables ",(0,a.jsx)(t.code,{children:"date"})," and ",(0,a.jsx)(t.code,{children:"count"}),"."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(90209).A+"",width:"876",height:"280"})}),"\n",(0,a.jsxs)(t.ol,{start:"4",children:["\n",(0,a.jsxs)(t.li,{children:["Pipe ",(0,a.jsx)(t.code,{children:"val.count"})," into ",(0,a.jsx)(t.code,{children:"toString"})," (shift-enter on a selected area also pipes\nthat expression)."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(29077).A+"",width:"864",height:"320"})}),"\n",(0,a.jsxs)(t.ol,{start:"5",children:["\n",(0,a.jsxs)(t.li,{children:["Return ",(0,a.jsx)(t.code,{children:'date ++ ": " ++ count'})," in the last line of the block."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(5293).A+"",width:"830",height:"346"})}),"\n",(0,a.jsxs)(t.ol,{start:"6",children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"We now have the code to generate our formatted report."}),"\n",(0,a.jsx)(t.p,{children:"Let's extract that code into a function. Select all the code within the REPL."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(47342).A+"",width:"1204",height:"648"})}),"\n",(0,a.jsxs)(t.ol,{start:"7",children:["\n",(0,a.jsxs)(t.li,{children:["Type ",(0,a.jsx)(t.code,{children:"Ctrl-\\"})," to open the command palette, then select ",(0,a.jsx)(t.code,{children:"extract-function"}),".\n(On some keyboards, you might instead need to press ",(0,a.jsx)(t.code,{children:"Alt-x"})," or ",(0,a.jsx)(t.code,{children:"Ctrl-s"}),")."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(60864).A+"",width:"1154",height:"666"})}),"\n",(0,a.jsxs)(t.ol,{start:"8",children:["\n",(0,a.jsx)(t.li,{children:"This creates the function, and replaces the existing code with a call to the\nnew function."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(4095).A+"",width:"852",height:"220"})}),"\n",(0,a.jsxs)(t.ol,{start:"9",children:["\n",(0,a.jsx)(t.li,{children:"Click on the function reference on the right hand side of the handler to go\nto the function and rename it."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(98965).A+"",width:"1352",height:"608"})}),"\n",(0,a.jsx)(t.p,{children:"Functions do not live on the main canvas. They are reusable and can be called\nfrom any handler."}),"\n",(0,a.jsx)(t.p,{children:"This function does not have any parameters. When you add parameters, the editor\nwill automatically create blanks for the arguments everywhere the function is\ncalled."}),"\n",(0,a.jsxs)(t.ol,{start:"10",children:["\n",(0,a.jsx)(t.li,{children:"Go back to the primary canvas via the sidebar, the mini-map, or a reference\non the right-hand-side of the function. Once back, create a new HTTP GET\nhandler and call the function. This creates an API endpoint which returns\nthe daily reports."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"gettingstarted/newworker.png",src:n(60807).A+"",width:"848",height:"168"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},5293:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/blockend-d094c72b13df470fb6a58bc9cdc7ac21.png"},52805:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/dbgetalldaily-0235edadce463fc4a6460bef43beb492.png"},4095:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/extractedfunction-fed2381a77887ecfa7cc1ecc0d28d6d9.png"},60864:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/extractfunction-180da21eda6eedac4909710b54f9d018.png"},60807:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/functioncall-6e7facf6dbfa762b5c0d04cf5e2c6039.png"},90209:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/functionmapvariable-dab7ae5bd3a2b471e551c4a3c965db00.png"},98965:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/functionspace-ff35a482e6bbc917dc2207e1abad6b0f.png"},47342:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/selectall-84b442d6952553ab5aa26346308c7dc3.png"},29077:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/valcounttostring-fdc1a8039875e32a597b3e971475504c.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var s=n(96540);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);