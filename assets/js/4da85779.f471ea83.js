"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5640],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=i.createContext({}),c=function(e){var t=i.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(d.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,d=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,h=p["".concat(d,".").concat(m)]||p[m]||s[m]||a;return n?i.createElement(h,o(o({ref:t},u),{},{components:n})):i.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=p;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<a;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},93075:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>l,contentTitle:()=>d,metadata:()=>c,toc:()=>u,default:()=>p});var i=n(87462),r=n(63366),a=(n(67294),n(3905)),o=["components"],l={title:"A tour of the Editor"},d=void 0,c={unversionedId:"contributing/tour-of-editor",id:"contributing/tour-of-editor",title:"A tour of the Editor",description:"The editor is in client/. We refer to it as the client or the editor (we don't",source:"@site/docs/contributing/tour-of-editor.md",sourceDirName:"contributing",slug:"/contributing/tour-of-editor",permalink:"/contributing/tour-of-editor",editUrl:"https://github.com/darklang/docs/edit/main/docs/contributing/tour-of-editor.md",tags:[],version:"current",frontMatter:{title:"A tour of the Editor"},sidebar:"Contributing",previous:{title:"General concepts",permalink:"/contributing/general-concepts"},next:{title:"A tour of the Backend",permalink:"/contributing/tour-of-backend"}},u=[{value:"Elm architecture",id:"elm-architecture",children:[{value:"The fluid editor",id:"the-fluid-editor",children:[],level:3},{value:"More coming soon",id:"more-coming-soon",children:[],level:3},{value:"Command palette",id:"command-palette",children:[],level:3},{value:"Autocomplete",id:"autocomplete",children:[],level:3},{value:"&quot;Forms&quot; editor",id:"forms-editor",children:[],level:3},{value:"Analysis",id:"analysis",children:[],level:3},{value:"Ops",id:"ops",children:[],level:3},{value:"An API call, end-to-end",id:"an-api-call-end-to-end",children:[],level:3}],level:2}],s={toc:u};function p(e){var t=e.components,n=(0,r.Z)(e,o);return(0,a.kt)("wrapper",(0,i.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"The editor is in ",(0,a.kt)("inlineCode",{parentName:"p"},"client/"),". We refer to it as the client or the editor (we don't\ncall it the frontend though)."),(0,a.kt)("p",null,"It started life as an Elm application, and still uses the Elm Architecture\n(which we like). The current app is in Bucklescript."),(0,a.kt)("h2",{id:"elm-architecture"},"Elm architecture"),(0,a.kt)("p",null,"The Elm architecture is a simple render loop, very similar to React (and\nespecially redux):"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"the entire application state is a single value called ",(0,a.kt)("inlineCode",{parentName:"li"},"model")),(0,a.kt)("li",{parentName:"ul"},"each user action creates a ",(0,a.kt)("inlineCode",{parentName:"li"},"Msg"),", which is passed to ",(0,a.kt)("inlineCode",{parentName:"li"},"Main.update")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Main.update")," produces a new ",(0,a.kt)("inlineCode",{parentName:"li"},"model"),", as well as some ",(0,a.kt)("inlineCode",{parentName:"li"},"Cmd"),", which are\ninteractions with the outside world."),(0,a.kt)("li",{parentName:"ul"},"Executing the ",(0,a.kt)("inlineCode",{parentName:"li"},"Cmd")," may introduce other ",(0,a.kt)("inlineCode",{parentName:"li"},"Msg"),"s, such as a ",(0,a.kt)("inlineCode",{parentName:"li"},"Cmd")," which makes an\nAPI call - the API response would be handled using a ",(0,a.kt)("inlineCode",{parentName:"li"},"Msg"),"."),(0,a.kt)("li",{parentName:"ul"},"Regularly, the ",(0,a.kt)("inlineCode",{parentName:"li"},"Main.view")," command is called to generate HTML. The HTML uses a\nVirtual DOM, like Elm and React do, and diffs the new Virtual DOM against the\nold one, applying the diffs to the real DOM.")),(0,a.kt)("p",null,"TODO: give an example of a lifecycle here"),(0,a.kt)("p",null,"The implications are interesting:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"all changes are functional - there are no changes to the model except through\nthe update,"),(0,a.kt)("li",{parentName:"ul"},"no callbacks - every event generates a message, which makes an orderly update,"),(0,a.kt)("li",{parentName:"ul"},"static typing - you are pretty much forced to handle all the events you\ncreate.")),(0,a.kt)("p",null,"There are also some downsides:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"components aren't as neat as in React; often a change is spread across the\napplication. Single changes often require changing 6 different files"),(0,a.kt)("li",{parentName:"ul"},"when you need something outside these bounds, it can be quite challenging to\nfind out how to do it"),(0,a.kt)("li",{parentName:"ul"},"does not always play well with traditional JS libraries (however, for an app\nlike ours which is often quite custom, this isn't that big a deal)")),(0,a.kt)("p",null,"This is how Elm architectures typically work. Our app mostly works like this,\nbut there are some exceptions:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Main.update")," delegates most of the work to ",(0,a.kt)("inlineCode",{parentName:"li"},"Main.update'"),". ",(0,a.kt)("inlineCode",{parentName:"li"},"Main.update'"),"\nproduces a ",(0,a.kt)("inlineCode",{parentName:"li"},"Modification")," instead of a ",(0,a.kt)("inlineCode",{parentName:"li"},"(Model, Cmd)"),", and a modification then\nproduces the ",(0,a.kt)("inlineCode",{parentName:"li"},"(Model, Cmd)")," pair you expect."),(0,a.kt)("li",{parentName:"ul"},"we do sometimes directly read from the DOM or other global state (like the\nrandom number generator or the History API)")),(0,a.kt)("p",null,"And there are some downsides to our app as well:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Main.ml")," is a mess"),(0,a.kt)("li",{parentName:"ul"},"modifications were a bad idea"),(0,a.kt)("li",{parentName:"ul"},"a single change can be spread far across the codebase")),(0,a.kt)("p",null,"Fortunately, we have started componentizing a little bit, and this has helped.\nThe Fluid codebase (actually editing the UI) for example is quite separated from\nunrelated code."),(0,a.kt)("h3",{id:"the-fluid-editor"},"The fluid editor"),(0,a.kt)("p",null,'Whenever you type code, you are using the "fluid" editor. This is a structured\neditor that is designed to feel like text when typing.'),(0,a.kt)("p",null,"A structured editor is means that you cannot write invalid code. The editor\nedits the AST of the program"),(0,a.kt)("h3",{id:"more-coming-soon"},"More coming soon"),(0,a.kt)("h3",{id:"command-palette"},"Command palette"),(0,a.kt)("h3",{id:"autocomplete"},"Autocomplete"),(0,a.kt)("h3",{id:"forms-editor"},'"Forms" editor'),(0,a.kt)("h3",{id:"analysis"},"Analysis"),(0,a.kt)("h3",{id:"ops"},"Ops"),(0,a.kt)("h3",{id:"an-api-call-end-to-end"},"An API call, end-to-end"))}p.isMDXComponent=!0}}]);